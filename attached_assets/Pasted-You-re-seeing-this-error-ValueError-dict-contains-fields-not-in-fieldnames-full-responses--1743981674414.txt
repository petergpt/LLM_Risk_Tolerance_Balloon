You're seeing this error:

```
ValueError: dict contains fields not in fieldnames: 'full_responses'
```

because each balloon dictionary includes a key `"full_responses"`, which is **not** in the CSV fieldnames you specified. Python’s CSV module raises an error if it sees keys in the row dict that are **not** declared in `fieldnames`.

Below is how to fix it:

1. **Remove** the `full_responses` key when merging or writing combined rows.
2. **Either** do it in your combined CSV function, **or** when you build `all_balloon_rows`.

Below is **one** recommended approach: in your `write_combined_csv(...)` function, do `row.pop("full_responses", None)` before `writer.writerow(row)`. That way, any extra key (like `"full_responses"`) is stripped out.


## Updated Example

Below is a snippet **from your `main.py`** (the combined CSV part). Just add the two lines labeled `# remove 'full_responses'`:

```python
def write_combined_csv(all_results, output_dir="logs"):
    ensure_dir_exists(output_dir)
    timestamp = datetime.utcnow().strftime("%Y%m%d-%H%M%S")
    filename = f"{output_dir}/BART_combined_{timestamp}.csv"

    fieldnames = [
        "model",
        "balloon_id",
        "threshold_pumps",
        "pumps_attempted",
        "burst",
        "earnings",
        "choices"
    ]

    with open(filename, "w", newline="", encoding="utf-8") as f:
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        writer.writeheader()
        for row in all_results:
            # If 'choices' is a list, turn it into a string
            if isinstance(row.get("choices"), list):
                row["choices"] = ", ".join(row["choices"])

            # remove 'full_responses' (and any other unwanted keys)
            if "full_responses" in row:
                row.pop("full_responses", None)

            writer.writerow(row)

    logging.info(f"Combined CSV written to: {filename}")
    return filename
```

That’s it! Now Python’s CSV writer won't see keys it doesn't expect.  
You can keep other logic the same, and the error should no longer appear.